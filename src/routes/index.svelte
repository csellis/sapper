<script>
  import { stores } from "@sapper/app";
  const { session } = stores();

  let email = "";
  let formState = "fresh";

  export async function handleSubmit() {
    formState = "sending";
    const body = {
      email
    };
    const response = await fetch("api/subscribe", {
      method: "POST",
      headers: {
        Accept: "application/json",
        "Content-Type": "application/json"
      },
      body: JSON.stringify(body)
    });
    const res = await response.json();

    if (res.id || res.error.code === "MEMBER_EXISTS_WITH_EMAIL_ADDRESS") {
      formState = "success";
    }
    console.log(res);
  }
</script>

<section class="flex text-gray-800 my-32 container mx-auto sm:px-4">
  <div>
    <h2 class="font-semibold text-3xl items-center">
      Create Svelte Apps Quickly,
      <br />
      No Boilerplate
    </h2>
    <h3 class="mt-8 text-xl font-hairline">
      Our package accelerates your Svelte product development, skipping all of
      the boilerplate.
    </h3>
  </div>
  <div class="pl-12">
    <img
      src="https://res.cloudinary.com/dkldjguam/image/upload/v1578824325/undraw_code_thinking_1jeh.svg"
      alt="Thinking about Svelte Backpack" />
  </div>
</section>

<section
  class="grid grid-cols-3 gap-12 m-12 my-24 container mx-auto sm:px-4"
  style="filter: grayscale(50%)">
  <div class="col-span-1">
    <img
      src="https://res.cloudinary.com/dkldjguam/image/upload/v1578826630/svelte-logo-horizontal.svg"
      alt="Svelte logo" />
  </div>
  <div class="col-span-1">
    <img
      src="https://res.cloudinary.com/dkldjguam/image/upload/v1578827096/tailwind-logo.svg"
      alt="Tailwind logo" />
  </div>
  <div class="col-span-1">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 943 220" fill="none">
      <g clip-path="url(#clip0)">
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M51.278 0H168.722C186.552 0 193.019 1.857 199.537 5.343C206.056
          8.829 211.171 13.945 214.657 20.463C218.144 26.982 220 33.447 220
          51.278V168.722C220 186.552 218.144 193.018 214.657 199.537C211.171
          206.055 206.056 211.171 199.537 214.657C193.019 218.143 186.553 220
          168.722 220H51.278C33.448 220 26.982 218.143 20.463 214.657C13.945
          211.171 8.829 206.055 5.343 199.537C1.857 193.018 0 186.553 0
          168.722V51.278C0 33.448 1.857 26.982 5.343 20.463C8.829 13.945 13.945
          8.829 20.463 5.343C26.982 1.857 33.447 0 51.278 0ZM63.04
          56.76V171H88.16V134.2L102.56 119.64L136.96 171H168.48L119.52
          101.88L164.16 56.76H132.8L88.16 104.12V56.76H63.04Z"
          fill="url(#paint0_linear)" />
      </g>
      <path
        d="M301 110.164L286.586
        124.367V161H277.938V58.625H286.586V113.82L339.039 58.625H349.938L307.047
        104.188L353.242 161H342.695L301 110.164ZM387.245 162.406C380.777 162.406
        374.917 160.812 369.667 157.625C364.464 154.438 360.409 150.008 357.503
        144.336C354.597 138.617 353.144 132.219 353.144 125.141V122.117C353.144
        114.805 354.55 108.219 357.363 102.359C360.222 96.5 364.183 91.9062
        369.245 88.5781C374.308 85.2031 379.792 83.5156 385.698 83.5156C394.933
        83.5156 402.245 86.6797 407.636 93.0078C413.073 99.2891 415.792 107.891
        415.792 118.812V123.523H361.511V125.141C361.511 133.766 363.972 140.961
        368.894 146.727C373.863 152.445 380.097 155.305 387.597 155.305C392.097
        155.305 396.058 154.484 399.48 152.844C402.948 151.203 406.089 148.578
        408.902 144.969L414.175 148.977C407.988 157.93 399.011 162.406 387.245
        162.406ZM385.698 90.6875C379.37 90.6875 374.027 93.0078 369.667
        97.6484C365.355 102.289 362.73 108.523 361.792
        116.352H407.425V115.438C407.191 108.125 405.105 102.172 401.167
        97.5781C397.23 92.9844 392.073 90.6875 385.698 90.6875ZM448.108
        148.906L470.327 84.9219H479.397L446.913 173.938L445.225 177.875C441.053
        187.109 434.608 191.727 425.889 191.727C423.873 191.727 421.717 191.398
        419.42 190.742L419.35 183.781L423.709 184.203C427.834 184.203 431.163
        183.172 433.694 181.109C436.272 179.094 438.452 175.602 440.233
        170.633L443.959 160.367L415.272 84.9219H424.483L448.108 148.906ZM530.837
        141.664C530.837 137.492 529.15 134.141 525.775 131.609C522.447 129.078
        517.408 127.109 510.658 125.703C503.908 124.25 498.658 122.609 494.908
        120.781C491.205 118.906 488.439 116.633 486.611 113.961C484.83 111.289
        483.939 108.055 483.939 104.258C483.939 98.2578 486.447 93.3125 491.462
        89.4219C496.478 85.4844 502.9 83.5156 510.728 83.5156C519.212 83.5156
        526.009 85.625 531.119 89.8438C536.275 94.0156 538.853 99.4766 538.853
        106.227H530.416C530.416 101.773 528.541 98.0703 524.791 95.1172C521.087
        92.1641 516.4 90.6875 510.728 90.6875C505.197 90.6875 500.744 91.9297
        497.369 94.4141C494.041 96.8516 492.377 100.039 492.377 103.977C492.377
        107.773 493.759 110.727 496.525 112.836C499.337 114.898 504.423 116.797
        511.783 118.531C519.189 120.266 524.72 122.117 528.377 124.086C532.08
        126.055 534.822 128.422 536.603 131.188C538.384 133.953 539.275 137.305
        539.275 141.242C539.275 147.664 536.673 152.797 531.47 156.641C526.314
        160.484 519.564 162.406 511.22 162.406C502.361 162.406 495.166 160.273
        489.634 156.008C484.15 151.695 481.408 146.258 481.408
        139.695H489.845C490.173 144.617 492.236 148.461 496.033 151.227C499.877
        153.945 504.939 155.305 511.22 155.305C517.08 155.305 521.814 154.016
        525.423 151.438C529.033 148.859 530.837 145.602 530.837 141.664ZM564.138
        65.4453V84.9219H579.888V91.8125H564.138V142.508C564.138 146.727 564.888
        149.867 566.388 151.93C567.934 153.992 570.489 155.023 574.052
        155.023C575.458 155.023 577.731 154.789 580.872 154.32L581.223
        161.211C579.02 162.008 576.02 162.406 572.223 162.406C566.458 162.406
        562.263 160.742 559.638 157.414C557.013 154.039 555.7 149.094 555.7
        142.578V91.8125H541.708V84.9219H555.7V65.4453H564.138ZM584.078
        121.836C584.078 114.523 585.484 107.938 588.297 102.078C591.156 96.2188
        595.164 91.6719 600.32 88.4375C605.523 85.1562 611.406 83.5156 617.969
        83.5156C628.094 83.5156 636.297 87.0781 642.578 94.2031C648.859 101.281
        652 110.68 652 122.398V124.156C652 131.516 650.57 138.148 647.711
        144.055C644.898 149.914 640.914 154.438 635.758 157.625C630.602 160.812
        624.719 162.406 618.109 162.406C608.031 162.406 599.828 158.867 593.5
        151.789C587.219 144.664 584.078 135.242 584.078 123.523V121.836ZM592.516
        124.156C592.516 133.25 594.859 140.727 599.547 146.586C604.281 152.398
        610.469 155.305 618.109 155.305C625.703 155.305 631.844 152.398 636.531
        146.586C641.266 140.727 643.633 133.016 643.633 123.453V121.836C643.633
        116.023 642.555 110.703 640.398 105.875C638.242 101.047 635.219 97.3203
        631.328 94.6953C627.438 92.0234 622.984 90.6875 617.969 90.6875C610.469
        90.6875 604.352 93.6406 599.617 99.5469C594.883 105.406 592.516 113.094
        592.516 122.609V124.156ZM670.253 84.9219L670.534 97.9297C673.394 93.2422
        676.956 89.6797 681.222 87.2422C685.487 84.7578 690.198 83.5156 695.355
        83.5156C703.511 83.5156 709.581 85.8125 713.566 90.4062C717.55 95
        719.566 101.891 719.612 111.078V161H711.245V111.008C711.198 104.211
        709.745 99.1484 706.886 95.8203C704.073 92.4922 699.55 90.8281 693.316
        90.8281C688.112 90.8281 683.495 92.4688 679.464 95.75C675.48 98.9844
        672.527 103.367 670.605 108.898V161H662.237V84.9219H670.253ZM763.67
        162.406C757.202 162.406 751.342 160.812 746.092 157.625C740.889 154.438
        736.834 150.008 733.928 144.336C731.022 138.617 729.569 132.219 729.569
        125.141V122.117C729.569 114.805 730.975 108.219 733.788 102.359C736.647
        96.5 740.608 91.9062 745.67 88.5781C750.733 85.2031 756.217 83.5156
        762.123 83.5156C771.358 83.5156 778.67 86.6797 784.061 93.0078C789.498
        99.2891 792.217 107.891 792.217 118.812V123.523H737.936V125.141C737.936
        133.766 740.397 140.961 745.319 146.727C750.288 152.445 756.522 155.305
        764.022 155.305C768.522 155.305 772.483 154.484 775.905 152.844C779.373
        151.203 782.514 148.578 785.327 144.969L790.6 148.977C784.413 157.93
        775.436 162.406 763.67 162.406ZM762.123 90.6875C755.795 90.6875 750.452
        93.0078 746.092 97.6484C741.78 102.289 739.155 108.523 738.217
        116.352H783.85V115.438C783.616 108.125 781.53 102.172 777.592
        97.5781C773.655 92.9844 768.498 90.6875 762.123 90.6875ZM848.58
        58.625H857.298V130.555C857.298 140.258 854.486 147.992 848.861
        153.758C843.283 159.523 835.783 162.406 826.361 162.406C816.423 162.406
        808.783 159.805 803.439 154.602C798.095 149.398 795.423 142.133 795.423
        132.805H804.072C804.072 140.211 806.017 145.789 809.908 149.539C813.798
        153.242 819.283 155.094 826.361 155.094C832.877 155.094 838.173 152.938
        842.252 148.625C846.377 144.312 848.486 138.453 848.58
        131.047V58.625ZM933.419 135.828C933.419 130.156 931.427 125.68 927.442
        122.398C923.458 119.07 916.169 115.93 905.575 112.977C894.981 109.977
        887.247 106.719 882.372 103.203C875.434 98.2344 871.966 91.7188 871.966
        83.6562C871.966 75.8281 875.177 69.4766 881.598 64.6016C888.067 59.6797
        896.317 57.2188 906.348 57.2188C913.145 57.2188 919.216 58.5312 924.559
        61.1562C929.95 63.7812 934.122 67.4375 937.075 72.125C940.028 76.8125
        941.505 82.0391 941.505 87.8047H932.786C932.786 80.8203 930.395 75.2188
        925.614 71C920.833 66.7344 914.411 64.6016 906.348 64.6016C898.52
        64.6016 892.286 66.3594 887.645 69.875C883.005 73.3438 880.684 77.8906
        880.684 83.5156C880.684 88.7188 882.77 92.9609 886.942 96.2422C891.114
        99.5234 897.794 102.43 906.981 104.961C916.169 107.445 923.13 110.047
        927.864 112.766C932.598 115.438 936.161 118.648 938.552 122.398C940.942
        126.148 942.138 130.578 942.138 135.688C942.138 143.75 938.903 150.219
        932.434 155.094C926.013 159.969 917.528 162.406 906.981 162.406C899.763
        162.406 893.13 161.117 887.083 158.539C881.083 155.961 876.513 152.352
        873.372 147.711C870.278 143.07 868.731 137.75 868.731
        131.75H877.38C877.38 138.969 880.075 144.664 885.466 148.836C890.856
        153.008 898.028 155.094 906.981 155.094C914.95 155.094 921.348 153.336
        926.177 149.82C931.005 146.305 933.419 141.641 933.419 135.828Z"
        fill="black" />
      <defs>
        <linearGradient
          id="paint0_linear"
          x1="0"
          y1="0"
          x2="110"
          y2="158.226"
          gradientUnits="userSpaceOnUse">
          <stop stop-color="#5AE8FA" />
          <stop offset="1" stop-color="#2684FF" />
        </linearGradient>
        <clipPath id="clip0">
          <rect width="220" height="220" fill="white" />
        </clipPath>
      </defs>
    </svg>
  </div>
</section>

<section
  class:hidden={formState === 'success'}
  class="container mx-auto sm:w-3/4 lg:w-1/2 sm:px-4 sm:py-8 mb-24 bg-white
  shadow text-gray-800 max-w-3xl">
  <div class="flex flex-col items-center justify-center">
    <h2 class="font-semibold text-3xl pt-12 pb-8">Ready to get started?</h2>
    <h3 class="text-xl pb-12">We will let you know when it's ready.</h3>
    <div class="">
      <form
        on:submit|preventDefault={handleSubmit}
        class="flex items-baseline"
        method="post">
        <input
          bind:value={email}
          class="appearance-none block w-full bg-gray-200 text-gray-700 border
          rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white
          mr-4"
          id="email"
          type="email"
          placeholder="email@example.com" />
        <button
          type="submit"
          class="btn flex-shrink-0"
          class:inactive={formState === 'sending'}>
          Get in Beta
        </button>
      </form>
    </div>
  </div>
</section>

<section
  class:hidden={formState !== 'success'}
  class="container mx-auto sm:w-3/4 lg:w-1/2 sm:px-4 sm:py-8 mb-24 bg-white
  shadow text-gray-800 max-w-3xl">
  <div class="flex flex-col items-center justify-center">
    <h2 class="font-semibold text-3xl pt-12 pb-8">
      Thank you for your interest!
    </h2>
    <h3 class="text-xl pb-12">Look out for an email shortly.</h3>
  </div>
</section>
